var __spreadArrays=this&&this.__spreadArrays||function(){for(var r=0,n=0,t=arguments.length;n<t;n++)r+=arguments[n].length;var i=Array(r),e=0;for(n=0;n<t;n++)for(var s=arguments[n],o=0,a=s.length;o<a;o++,e++)i[e]=s[o];return i};function _arrify(r){return void 0===r?[]:r instanceof Array?r:[r]}var ArgsPromiseInitOpts=function(r,n){void 0===r&&(r=new Promise((function(){}))),void 0===n&&(n=[]),this.residents=n,this.promise=r},ArgsPromise=function(){function r(r){var n=this;if(r instanceof ArgsPromiseInitOpts)this._residents=r.residents,this._promise=r.promise;else{if(!(r instanceof Function))throw new Error("The constructor of ArgsPromise expects an executor function as argument.");this._residents=[],this._promise=new Promise((function(t,i){r((function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t(r)}),(function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];i(r)}),(function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];n._residents=r}))}))}}return r.prototype.then=function(n,t){var i=this,e=n?function(r){return _arrify(n.apply(void 0,__spreadArrays(r,i._residents)))}:void 0,s=t?function(r){return _arrify(t.apply(void 0,__spreadArrays(r,i._residents)))}:void 0;return new r(new ArgsPromiseInitOpts(this._promise.then(e,s),this._residents))},r.prototype.catch=function(n){var t=this,i=n?function(r){return _arrify(n.apply(void 0,__spreadArrays(r,t._residents)))}:void 0;return new r(new ArgsPromiseInitOpts(this._promise.catch(i),this._residents))},r.prototype.finally=function(n){var t=this,i=n?function(){return _arrify(n.apply(void 0,t._residents))}:void 0;return new r(new ArgsPromiseInitOpts(this._promise.finally(i),this._residents))},r.prototype.pack=function(){var n=this;return new r((function(r){n._promise.then((function(t){r(__spreadArrays(t,n._residents))}))}))},r.prototype.to=function(){var n=this;return new r((function(r){n._promise.then((function(t){r([null,__spreadArrays(t,n._residents)])})).catch((function(t){r([__spreadArrays(t,n._residents),void 0])}))}))},r}();